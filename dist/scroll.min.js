/**
 * vite-scroll v1.0.0
 * (c) 2014-2020 by elvin zhu
 * Released under the MIT License.
 */

!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports):"function"==typeof define&&define.amd?define(["exports"],e):e((t=t||self).Scroll={})}(this,(function(t){"use strict";function e(t,e,n,i){void 0===i&&(i=!1),t.addEventListener(e,n,i)}function n(t,e,n,i){void 0===i&&(i=!1),t.removeEventListener(e,n,i)}var i=["webkit","ms","moz","o"];function r(t,e){var n=e||document.body.style;if(!(t in n))for(var r=t.charAt(0).toUpperCase(),o=t.substr(1),s=0;s<i.length;s++){var h=i[s]+r+o;if(h in n)return h}return t}var o,s=window[r("requestAnimationFrame")]||function(t){return setTimeout(t,16.6)},h=function(){function t(i,o){if(this.LOG_PREFIX="[ViteScroll]ï¼š",this.VERSION="v1.0.0",this.SPEED_DETECT_INTERVAL=200,this.MAX_OVERFLOW=120,this.MIN_SPEED=.01,this.TOUCH_RESISTANCE=.1,this.WINDAGE_RESISTANCE=.3,this.ELASTIC_RESISTANCE=.2,this.tranformStyleName=r("transform"),this.scrollTouches={},this.touchStarted=!1,this.scrolling=!1,this.containerHeight=0,this.contentHeight=0,this.minTranslate=0,this.originCurrent=0,this.current=0,!(this instanceof t))return new t(i,o);if(!(i instanceof HTMLElement))throw new Error(this.LOG_PREFIX+"ViteScroll can only work on HTMLElement. Please check the `el` argument.");if(i.__vite_scroll_instance)return console.warn(this.LOG_PREFIX+"there is already a ViteScroll instance associated with this element."),i.__vite_scroll_instance;this.container=i,this.content=i.querySelector(":first-child"),this.onStart=this.onStart.bind(this),this.onMove=this.onMove.bind(this),this.onEnd=this.onEnd.bind(this),this._unbindXTouch=function(t,i){if("[object Object]"!==Object.prototype.toString.call(i))throw new Error("[xtouch]: argument `options` is missing or illegal.");var r=i.onStart,o=i.onMove,s=i.onEnd,h=i.capture,c=null,a=function(t){"mousedown"===t.type&&(c=t.target,t.identifier=0,t.touches=t.changedTouches=[t],t.targetTouches=[t]),r(t)},u=function(t){"mousemove"===t.type&&(t.identifier=0,t.touches=t.changedTouches=[t],t.targetTouches=t.target===c?[t]:[]),o(t)},l=function(t){"mouseup"===t.type&&(t.identifier=0,t.touches=[],t.changedTouches=[t],t.targetTouches=t.target===c?[t]:[]),s(t)};return r&&(e(t,"touchstart",a,h),e(t,"mousedown",a,h)),o&&(e(window,"touchmove",u,h),e(window,"mousemove",u,h)),s&&(e(window,"touchend",l,h),e(window,"mouseup",l,h)),function(){n(t,"touchstart",a,h),n(window,"touchmove",u,h),n(window,"touchend",l,h),n(t,"mousedown",a,h),n(window,"mousemove",u,h),n(window,"mouseup",l,h)}}(this.container,{onStart:this.onStart,onEnd:this.onEnd,onMove:this.onMove,capture:{passive:!1}}),e(i,"touchcancel",this.onEnd,!0)}return t.prototype.destroy=function(){n(this.container,"touchcancel",this.onEnd,!0),this.container.__vite_scroll_instance=void 0,this._unbindXTouch()},t.prototype.onStart=function(t){1===t.touches.length&&(this.containerHeight=this.getOccupiedHeight(this.container),this.contentHeight=this.getOccupiedHeight(this.content),this.originCurrent=this.current=this.getTranslate(this.content),this.minTranslate=this.containerHeight-this.contentHeight,this.scrolling=!1,this.touchStarted=!0),this.scrollTouches[t.changedTouches[0].identifier]={touchStart:t.changedTouches[0].pageY,speedStart:this.current,speedStartTime:t.timeStamp}},t.prototype.onMove=function(t){if(this.touchStarted){var e=this._handleMove(t,t.changedTouches[0]);if(2===t.changedTouches.length)e=Math.max(e,this._handleMove(t,t.changedTouches[1]));else if(t.changedTouches.length>2){for(var n=[e],i=1,r=t.changedTouches.length;i<r;i++)n.push(this._handleMove(t,t.changedTouches[i]));e=Math.max.apply(Math,n)}this.originCurrent+=e,this.originCurrent>0?e>0?this.current=this.originCurrent*this.ELASTIC_RESISTANCE:(this.current+=e,this.originCurrent=this.current/this.ELASTIC_RESISTANCE):this.originCurrent<this.minTranslate?e<0?this.current=this.minTranslate+(this.originCurrent-this.minTranslate)*this.ELASTIC_RESISTANCE:(this.current+=e,this.originCurrent=this.minTranslate+(this.current-this.minTranslate)/this.ELASTIC_RESISTANCE):this.current=this.originCurrent,this.setTranslate(this.current),t.preventDefault()}},t.prototype._handleMove=function(t,e){var n=this.scrollTouches[e.identifier];if(n){var i=e.pageY-n.touchStart;return n.touchStart=e.pageY,t.timeStamp-n.speedStartTime>this.SPEED_DETECT_INTERVAL&&(n.speedStart=this.current,n.speedStartTime=t.timeStamp),i}return 0},t.prototype.onEnd=function(t){var e=this;if(0===t.touches.length){var n=t.changedTouches[0].identifier;this.touchStarted=!1;var i=this.scrollTouches[n];if(i){var r=(this.current-i.speedStart)/((t.timeStamp-i.speedStartTime)/16.6);this.scrollAt(r)}}Array.from(t.changedTouches).forEach((function(t){e.scrollTouches[t.identifier]=null}))},t.prototype.scrollTo=function(t){var e=this;this.scrolling=!0;var n=function(){if(e.scrolling){var i=e.current-t;Math.abs(i)<e.MIN_SPEED?e.current=t:(e.current-=.12*i,s(n)),e.setTranslate(e.current)}};s(n)},t.prototype.scrollAt=function(t){var e=this,n=Math.abs(t);if(!n||n<this.MIN_SPEED)this.resetPosition();else{this.scrolling=!0;var i,r=n,o=t<0,h=function(){e.scrolling&&(r-=r/n*e.WINDAGE_RESISTANCE+e.TOUCH_RESISTANCE,e.current+=o?-r:r,e.setTranslate(e.current),i=Math.min(3*r,e.MAX_OVERFLOW),e.current>i?e.scrollTo(0):e.current<e.minTranslate-i?e.scrollTo(e.minTranslate):r>0&&s(h))};s(h)}},t.prototype.resetPosition=function(){this.current>0?this.scrollTo(0):this.current<this.minTranslate&&this.scrollTo(this.minTranslate)},t.prototype.setTranslate=function(t){this.content.style[this.tranformStyleName]="translate3d(0,"+t+"px,0)"},t.prototype.getTranslate=function(t){var e=window.getComputedStyle(t)[this.tranformStyleName];return e&&"none"!==e?parseFloat(e.split(")")[0].split(",")[5]):0},t.prototype.getOccupiedHeight=function(t){var e=window.getComputedStyle(t);return parseFloat(e.height)+parseFloat(e.marginTop)+parseFloat(e.marginBottom)},t}();(o=t.Direction||(t.Direction={}))[o.X=0]="X",o[o.Y=1]="Y",o[o.Both=2]="Both",t.default=h,Object.defineProperty(t,"__esModule",{value:!0})}));
